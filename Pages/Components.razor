@page "/components"

<PageTitle>Components - Coloress</PageTitle>

<div class="page-header">
    <h1>Component Showcase üß©</h1>
    <p>Explore various Blazor component patterns and interactions</p>
</div>

<section class="showcase-section">
    <h2>Form Inputs & Two-Way Binding</h2>
    <div class="demo-container">
        <div class="input-group">
            <label>Your Name:</label>
            <input @bind="userName" @bind:event="oninput" placeholder="Enter your name" />
        </div>
        <div class="output-display">
            <p>Hello, <strong>@(string.IsNullOrEmpty(userName) ? "stranger" : userName)</strong>! üëã</p>
        </div>
    </div>
</section>

<section class="showcase-section">
    <h2>Conditional Rendering</h2>
    <div class="demo-container">
        <button class="btn btn-primary" @onclick="ToggleVisibility">
            @(isVisible ? "Hide" : "Show") Message
        </button>
        
        @if (isVisible)
        {
            <div class="alert alert-success">
                ‚ú® This message appears conditionally based on component state!
            </div>
        }
    </div>
</section>

<section class="showcase-section">
    <h2>List Rendering & Iteration</h2>
    <div class="demo-container">
        <div class="input-group">
            <input @bind="newItem" @bind:event="oninput" placeholder="Add a task" @onkeypress="HandleKeyPress" />
            <button class="btn btn-primary" @onclick="AddItem">Add Task</button>
        </div>
        
        @if (items.Any())
        {
            <ul class="task-list">
                @foreach (var item in items)
                {
                    <li class="task-item">
                        <span>@item</span>
                        <button class="btn-remove" @onclick="() => RemoveItem(item)">‚úï</button>
                    </li>
                }
            </ul>
            <button class="btn btn-danger btn-sm" @onclick="ClearItems">Clear All</button>
        }
        else
        {
            <p class="empty-state">No tasks yet. Add one above! üìù</p>
        }
    </div>
</section>

<section class="showcase-section">
    <h2>Color Picker & Styling</h2>
    <div class="demo-container">
        <div class="color-picker-group">
            <label>Choose a color:</label>
            <input type="color" @bind="selectedColor" @bind:event="oninput" />
            <span class="color-value">@selectedColor</span>
        </div>
        <div class="color-preview" style="background-color: @selectedColor;">
            <p style="color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.5);">
                Preview Box
            </p>
        </div>
    </div>
</section>

<section class="showcase-section">
    <h2>Timer & Lifecycle</h2>
    <div class="demo-container">
        <div class="timer-display">
            <div class="timer-value">@elapsedSeconds</div>
            <div class="timer-label">seconds elapsed</div>
        </div>
        <div class="timer-controls">
            <button class="btn @(isTimerRunning ? "btn-danger" : "btn-primary")" @onclick="ToggleTimer">
                @(isTimerRunning ? "‚è∏ Pause" : "‚ñ∂ Start")
            </button>
            <button class="btn btn-secondary" @onclick="ResetTimer">üîÑ Reset</button>
        </div>
    </div>
</section>

<div class="info-box">
    <h3>üí° Component Concepts Demonstrated</h3>
    <ul>
        <li><strong>Two-way binding:</strong> <code>@("@")bind</code> directive for form inputs</li>
        <li><strong>Event handling:</strong> <code>@("@")onclick</code>, <code>@("@")onkeypress</code></li>
        <li><strong>Conditional rendering:</strong> <code>@("@")if</code> statements</li>
        <li><strong>List rendering:</strong> <code>@("@")foreach</code> loops</li>
        <li><strong>Lifecycle methods:</strong> <code>OnInitialized</code>, <code>Dispose</code></li>
        <li><strong>Timers:</strong> Using <code>System.Threading.Timer</code></li>
    </ul>
</div>

@code {
    // Form binding
    private string userName = "";
    
    // Conditional rendering
    private bool isVisible = false;
    
    // List rendering
    private List<string> items = new();
    private string newItem = "";
    
    // Color picker
    private string selectedColor = "#6366f1";
    
    // Timer
    private int elapsedSeconds = 0;
    private bool isTimerRunning = false;
    private System.Threading.Timer? timer;
    
    protected override void OnInitialized()
    {
        timer = new System.Threading.Timer(_ =>
        {
            if (isTimerRunning)
            {
                elapsedSeconds++;
                InvokeAsync(StateHasChanged);
            }
        }, null, TimeSpan.Zero, TimeSpan.FromSeconds(1));
    }
    
    private void ToggleVisibility()
    {
        isVisible = !isVisible;
    }
    
    private void AddItem()
    {
        if (!string.IsNullOrWhiteSpace(newItem))
        {
            items.Add(newItem);
            newItem = "";
        }
    }
    
    private void RemoveItem(string item)
    {
        items.Remove(item);
    }
    
    private void ClearItems()
    {
        items.Clear();
    }
    
    private void HandleKeyPress(KeyboardEventArgs e)
    {
        if (e.Key == "Enter")
        {
            AddItem();
        }
    }
    
    private void ToggleTimer()
    {
        isTimerRunning = !isTimerRunning;
    }
    
    private void ResetTimer()
    {
        elapsedSeconds = 0;
        isTimerRunning = false;
    }
    
    public void Dispose()
    {
        timer?.Dispose();
    }
}

@implements IDisposable
